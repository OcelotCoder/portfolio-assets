<style>
  @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&display=swap');

  body {
    background-color: white;
  }

  .turntable-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
  }

  .turntable-container {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 300px;
    background-color: white;
    transition: all 0.5s ease-in-out;
  }

  .turntable-column {
    position: relative;
    height: 100%;
    background-color: white;
    transition: all 0.5s ease-in-out;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    width: 33.33%;
    padding-bottom: 20px;
  }

  .turntable-column img {
    width: 100%;
    height: calc(100% - 30px);
    object-fit: contain;
    transition: opacity 0.2s ease-in-out;
  }

  .content-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 33.33%;
    padding: 0 10px;
  }

  .turntable-wrapper {
    display: flex;
    justify-content: center;
    width: 100%;
    gap: 20px;
    margin-top: 20px;
  }
  
  .video-label {
    font-family: 'Oswald', sans-serif;
    font-size: 12px;
    color: black;
    text-align: center;
    text-transform: uppercase;
    flex: 1 1 33.33%;
    max-width: 33.33%;
    min-width: 0;
    margin-top: 10px;
  }

  .thumbnail-container {
    display: flex;
    justify-content: center;
    gap: 5px;
    margin-top: 10px;
  }

  .thumbnail-container img {
    width: 50px;
    height: 50px;
    object-fit: cover;
    border: 2px solid transparent;
    cursor: pointer;
    transition: border-color 0.2s ease;
  }

  .thumbnail-container img:hover {
    border-color: #555;
  }

  .thumbnail-container img.highlight {
    border-color: #555;
  }

  .slider-bar-container {
    position: relative;
    width: calc(100% - 20px);
    height: 4px;
    background-color: #e0e0e0;
    cursor: grab;
    margin-top: auto;
    margin-bottom: 5px;
  }

  .slider-bar-fill {
    height: 100%;
    width: 0;
    background-color: #555;
  }

  .slider-handle {
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 14px;
    height: 14px;
    background-color: #7e49b7;
    border-radius: 50%;
    cursor: grab;
    z-index: 10;
  }
</style>

<div class="turntable-section">
  <div class="turntable-container">
    <div class="turntable-column">
      <img id="gecko" src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Gecko1.png" alt="Leaf-tail gecko turntable">
      <div class="slider-bar-container" id="gecko-slider-bar">
        <div class="slider-bar-fill" id="gecko-slider-fill"></div>
        <div class="slider-handle" id="gecko-slider-handle"></div>
      </div>
    </div>
    <div class="turntable-column">
      <img id="skink" src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Skink1NEW.png" alt="Sun-skink turntable">
      <div class="slider-bar-container" id="skink-slider-bar">
        <div class="slider-bar-fill" id="skink-slider-fill"></div>
        <div class="slider-handle" id="skink-slider-handle"></div>
      </div>
    </div>
    <div class="turntable-column">
      <img id="lizard" src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Lizard1.png" alt="Horned lizard turntable">
      <div class="slider-bar-container" id="lizard-slider-bar">
        <div class="slider-bar-fill" id="lizard-slider-fill"></div>
        <div class="slider-handle" id="lizard-slider-handle"></div>
      </div>
    </div>
  </div>

  <div class="turntable-wrapper">
    <div class="content-wrapper">
      <div class="video-label">Leaf-tail gecko</div>
      <div class="thumbnail-container" id="gecko-thumbnails">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Gecko1.png" alt="Gecko Thumbnail 1" class="highlight">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Gecko2.png" alt="Gecko Thumbnail 2">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Gecko3.png" alt="Gecko Thumbnail 3">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Gecko4.png" alt="Gecko Thumbnail 4">
      </div>
    </div>
    
    <div class="content-wrapper">
      <div class="video-label">Sun-skink</div>
      <div class="thumbnail-container" id="skink-thumbnails">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Skink1NEW.png" alt="Skink Thumbnail 1" class="highlight">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Skink2.png" alt="Skink Thumbnail 2">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Skink3.png" alt="Skink Thumbnail 3">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Skink4.png" alt="Skink Thumbnail 4">
      </div>
    </div>

    <div class="content-wrapper">
      <div class="video-label">Horned lizard</div>
      <div class="thumbnail-container" id="lizard-thumbnails">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Lizard1.png" alt="Lizard Thumbnail 1" class="highlight">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Lizard2.png" alt="Lizard Thumbnail 2">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Lizard3.png" alt="Lizard Thumbnail 3">
        <img src="https://raw.githubusercontent.com/OcelotCoder/portfolio-assets/main/Lizard4.png" alt="Lizard Thumbnail 4">
      </div>
    </div>
  </div>
</div>

<script>
  const geckoMain = document.getElementById('gecko');
  const skinkMain = document.getElementById('skink');
  const lizardMain = document.getElementById('lizard');

  const geckoThumbnails = document.getElementById('gecko-thumbnails');
  const skinkThumbnails = document.getElementById('skink-thumbnails');
  const lizardThumbnails = document.getElementById('lizard-thumbnails');

  const geckoSliderBar = document.getElementById('gecko-slider-bar');
  const skinkSliderBar = document.getElementById('skink-slider-bar');
  const lizardSliderBar = document.getElementById('lizard-slider-bar');

  const geckoSliderHandle = document.getElementById('gecko-slider-handle');
  const skinkSliderHandle = document.getElementById('skink-slider-handle');
  const lizardSliderHandle = document.getElementById('lizard-slider-handle');

  const geckoSliderFill = document.getElementById('gecko-slider-fill');
  const skinkSliderFill = document.getElementById('skink-slider-fill');
  const lizardSliderFill = document.getElementById('lizard-slider-fill');

  const imagesSets = [
    { main: geckoMain, thumbnails: geckoThumbnails, slider: geckoSliderBar, handle: geckoSliderHandle, fill: geckoSliderFill, totalImages: 4 },
    { main: skinkMain, thumbnails: skinkThumbnails, slider: skinkSliderBar, handle: skinkSliderHandle, fill: skinkSliderFill, totalImages: 4 },
    { main: lizardMain, thumbnails: lizardThumbnails, slider: lizardSliderBar, handle: lizardSliderHandle, fill: lizardSliderFill, totalImages: 4 }
  ];

  let isDraggingSlider = false;
  let activeSliderSet = null;

  function updateState(setIndex, progress) {
    const { main, thumbnails, slider, handle, fill, totalImages } = imagesSets[setIndex];
    const imageElements = thumbnails.querySelectorAll('img');

    let newIndex = Math.floor(progress * (totalImages));
    if (newIndex >= totalImages) {
        newIndex = totalImages - 1;
    }
    
    // check if image needs to be changed
    if (main.src !== imageElements[newIndex].src) {
        // set opacity 0 for quick fade-out
        main.style.opacity = 0;
        setTimeout(() => {
            main.src = imageElements[newIndex].src;
            // set opacity 1 for fade-in
            main.style.opacity = 1;
        }, 100); // wait 100ms for fade-out to complete
    }

    imageElements.forEach((img, i) => {
      if (i === newIndex) {
        img.classList.add('highlight');
      } else {
        img.classList.remove('highlight');
      }
    });

    const progressBarWidth = slider.offsetWidth;
    fill.style.width = (progress * 100) + '%';
    handle.style.left = (progress * progressBarWidth) + 'px';
  }

  function startSliderDrag(e, setIndex) {
    isDraggingSlider = true;
    activeSliderSet = imagesSets[setIndex];
    document.body.style.cursor = 'grabbing';
    handleSliderDrag(e);
  }

  function handleSliderDrag(e) {
    if (!isDraggingSlider || !activeSliderSet) return;
    e.preventDefault();

    const { slider } = activeSliderSet;
    const rect = slider.getBoundingClientRect();
    let clientX = e.clientX || (e.touches && e.touches[0] ? e.touches[0].clientX : null);
    if (clientX === null) return;

    let x = clientX - rect.left;
    x = Math.max(0, Math.min(x, rect.width));

    const progress = x / rect.width;
    const currentSetIndex = imagesSets.indexOf(activeSliderSet);
    updateState(currentSetIndex, progress);
  }

  function endSliderDrag() {
    isDraggingSlider = false;
    activeSliderSet = null;
    document.body.style.cursor = 'grab';
  }

  imagesSets.forEach((set, setIndex) => {
    set.thumbnails.addEventListener('click', (e) => {
      if (e.target.tagName === 'IMG') {
        const newIndex = Array.from(set.thumbnails.querySelectorAll('img')).indexOf(e.target);
        const progress = newIndex / (set.totalImages - 1);
        updateState(setIndex, progress);
      }
    });

    set.handle.addEventListener('mousedown', (e) => startSliderDrag(e, setIndex));
    set.handle.addEventListener('touchstart', (e) => startSliderDrag(e, setIndex));
  });

  document.addEventListener('mousemove', handleSliderDrag);
  document.addEventListener('mouseup', endSliderDrag);
  document.addEventListener('touchmove', handleSliderDrag);
  document.addEventListener('touchend', endSliderDrag);

  imagesSets.forEach((set, setIndex) => {
    set.slider.addEventListener('click', (e) => {
      const rect = set.slider.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const progress = x / rect.width;
      updateState(setIndex, progress);
    });
  });

  imagesSets.forEach((set, setIndex) => {
    updateState(setIndex, 0);
  });
</script>
